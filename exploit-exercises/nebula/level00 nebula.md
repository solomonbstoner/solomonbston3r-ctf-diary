# For Level 00 in Nebula

>This level requires you to find a Set User ID program that will run as the “flag00” account. You could also find this by carefully looking in top level directories in / for suspicious looking directories.
>  
>Alternatively, look at the find man page.
>  
>To access this level, log in as level00 with the password of level00.


### Winning strategy

The program wants us to "find a Set User ID program that will run as the flag00 account". This program has to be owned by `flag00`.

> when it is run, the effective
user ID of the process will be that of the file's owner rather than the effective user ID of the process
that performed the exec call. (The real user ID will still be that of the executing user.)

The quote above comes from *"10.4.1 Setuid Programs"* of the book [Advanged Linux Programming](http://www.cse.hcmut.edu.vn/~hungnq/courses/nap/alp.pdf).

```
level00@nebula:~$ find / -user flag00 2> /dev/null
/bin/.../flag00
/home/flag00
/home/flag00/.bash_logout
/home/flag00/.bashrc
/home/flag00/.profile
/rofs/bin/.../flag00
/rofs/home/flag00
/rofs/home/flag00/.bash_logout
/rofs/home/flag00/.bashrc
/rofs/home/flag00/.profile
level00@nebula:~$
```

With the `find` command, we find everything that belongs to `flag00`. `/bin/.../` looks like a very suspicious directory. Seldom are directories named like that. It seems almost intentional.

```
level00@nebula:~$ cd /bin/.../
level00@nebula:/bin/...$ file flag00
flag00: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.15, not stripped
level00@nebula:/bin/...$ ls -l flag00
-rwsr-x--- 1 flag00 level00 7358 2011-11-20 21:22 flag00
```
Do you notice the `s` in `-rwsr-x---`? That `s` means the program is a setuid program.

We change to that directory, and verify that `/bin/.../flag00` is indeed an executable owned by `flag00`.

```
level00@nebula:/bin/...$ ./flag00
Congrats, now run getflag to get your flag!
flag00@nebula:/bin/...$ getflag
You have successfully executed getflag on a target account
flag00@nebula:/bin/...$ 
```

We run that program, and we have become `flag00`.

END
